# ä¸è·¯æ™ºæ˜Ÿ - SilkRoadStar

<div align="center">
  <!-- Logoå±•ç¤ºåŒº -->
  <!-- è¯·å°†æ‚¨çš„Logoå›¾ç‰‡ä¿å­˜ä¸º assets/images/logo.png -->
  <h1>ğŸŒŸ ä¸è·¯æ™ºæ˜Ÿ</h1>
  <h3>SlopeStar Nexus</h3>
  <p><strong>é’å°‘å¹´ç¼–ç¨‹æ•™è‚²å¹³å°</strong></p>
  <p><em>è¿½é€æ•™è‚²æ¢¦æƒ³ä¸æ¢ç´¢</em></p>
  
  [![GitHub stars](https://img.shields.io/github/stars/18848007642/easy-scratch2?style=social)](https://github.com/18848007642/easy-scratch2)
  [![License](https://img.shields.io/badge/license-GPL--2.0-blue.svg)](LICENSE)
  [![Version](https://img.shields.io/badge/version-1.0.0-green.svg)](https://github.com/18848007642/easy-scratch2/releases)
</div>

## é¡¹ç›®ä»‹ç»

**ä¸è·¯æ™ºæ˜Ÿ**æ˜¯åŸºäº Scratch 2.0 æ·±åº¦å®šåˆ¶çš„é’å°‘å¹´ç¼–ç¨‹æ•™è‚²å¹³å°ã€‚é€šè¿‡å›¾å½¢åŒ–ç¼–ç¨‹ç•Œé¢ï¼Œè®©å­©å­ä»¬åœ¨æ¸¸æˆä¸­å­¦ä¹ ç¼–ç¨‹æ€ç»´ï¼ŒåŸ¹å…»é€»è¾‘èƒ½åŠ›å’Œåˆ›é€ åŠ›ã€‚

### âœ¨ ç‰¹è‰²åŠŸèƒ½

- ğŸ¨ **å…¨æ–°å“ç‰Œç•Œé¢** - ä¸è·¯æ™ºæ˜Ÿä¸»é¢˜è®¾è®¡ï¼Œè“é‡‘é…è‰²æ›´æ˜¾ä¸“ä¸š
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ** - æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ç­‰å¤šç§è¯­è¨€
- ğŸ“š **ä¸°å¯Œç´ æåº“** - åŒ…å«ä¸è·¯æ–‡åŒ–ä¸»é¢˜ç´ æ
- ğŸ¤– **AI ç¼–ç¨‹åŠ©æ‰‹** - æ™ºèƒ½æç¤ºå’Œä»£ç è¾…åŠ©
- â˜ï¸ **äº‘ç«¯å­˜å‚¨** - é¡¹ç›®è‡ªåŠ¨ä¿å­˜åˆ°äº‘ç«¯
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ **å®¶é•¿ç›‘æ§** - å­¦ä¹ è¿›åº¦å®æ—¶è¿½è¸ª


## ä½¿ç”¨æ–¹æ³•
### ç›´æ¥ä½¿ç”¨
demoè§ç¼–è¯‘çš„bin-debug/scratch2.htmlæ–‡ä»¶

Chromeå·²ç¦æ­¢Flashæ’ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–æµè§ˆå™¨æˆ–IEã€Edge


### å‚ä¸æœ¬é¡¹ç›®
æœ¬é¡¹ç›®æ¥å—PRï¼Œå¦‚æœå¤§ä½¬æœ‰æ›´å¥½çš„å®ç°æ–¹æ³•å’Œæ›´å¥½çš„åˆ›æ„ï¼Œæ¬¢è¿æäº¤PRï¼

åŒæ—¶ä¹Ÿæ¬¢è¿æå‡ºIssueï¼ŒBUGå»ºè®®å‡å¯

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ bin-debug                # ç¼–è¯‘åçš„æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ internalapi          # ç´ æåº“èµ„æº
â”‚   â”œâ”€â”€ scratchr2            # ç´ æåº“ç´¢å¼•
â”‚   â”œâ”€â”€ locale               # è¯­è¨€åŒ…    
â”‚   â”œâ”€â”€ siteapi              # api demo
â”‚   â”œâ”€â”€ js                   # ç”¨çš„çš„jsæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ scratch.js       # scratchåˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ swfobject.js     # flashå’Œjsäº¤äº’
â”‚   â”œâ”€â”€ scratch2.html        # scratché¡µé¢demo
â”‚   â””â”€â”€ scratch2.swf         # scratchæœ¬ä½“
â”œâ”€â”€ libs                     # as3åº“
â”œâ”€â”€ html-template            # htmlç¼–è¯‘æ¨¡æ¿
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ assets           # èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ blocks           # ç§¯æœ¨ç›¸å…³
â”‚   â”œâ”€â”€ com              # ç¬¬ä¸‰æ–¹åº“
â”‚   â”œâ”€â”€ extensions       # æ‹“å±•ç®¡ç†
â”‚   â”œâ”€â”€ filters          # å›¾åƒå¤„ç†ç›¸å…³
â”‚   â”œâ”€â”€ interpreter      # ç§¯æœ¨è§£é‡Šå™¨
â”‚   â”œâ”€â”€ leelib           # flvç¼–ç æ’ä»¶
â”‚   â”œâ”€â”€ logging          # æ—¥å¿—å·¥å…·ç±»
â”‚   â”œâ”€â”€ primitives       # ç§¯æœ¨åŸºç±»
â”‚   â”œâ”€â”€ scratch          # scratchæ ¸å¿ƒ
â”‚   â”œâ”€â”€ sound            # å£°éŸ³å¤„ç†
â”‚   â”œâ”€â”€ soundbank        # éŸ³é¢‘èµ„æº
â”‚   â”œâ”€â”€ soundedit        # å£°éŸ³ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ svgeditor        # svgç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ svgutils         # svgå·¥å…·ç±»
â”‚   â”œâ”€â”€ ui               # uiå®ç°
â”‚   â”œâ”€â”€ uiwidgets        # uiç»„ä»¶
â”‚   â”œâ”€â”€ util             # å·¥å…·ç±»
â”‚   â”œâ”€â”€ CSS.as           # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ Specs.as         # ç§¯æœ¨çš„å®šä¹‰å’Œåˆ†ç±»
â”‚   â”œâ”€â”€ Scratch.as       # Scratchä¸»æ–‡ä»¶
â”‚   â””â”€â”€ scratch2.mxml    # ç•Œé¢ç»„ä»¶å¸ƒå±€
â”œâ”€â”€ README.md
â”œâ”€â”€ README-RAW.md        # å®˜æ–¹åŸç‰ˆREADME
â””â”€â”€ package.json
â””â”€â”€ webpack.consig.js
```



# äºŒæ¬¡å¼€å‘

## å¼€å‘ç¯å¢ƒæ­å»ºå’Œç¼–è¯‘

https://www.213.name/archives/1033

## å°†Scratchæ‰“åŒ…ä¸ºAiråº”ç”¨

https://www.213.name/archives/1756

## Webç‰ˆScratch Debug

å»ºè®®ä½¿ç”¨FireFoxæµè§ˆå™¨

1. ä¸‹è½½ç›¸åº”æµè§ˆå™¨çš„flash player debugger ï¼ˆNPAPIï¼‰

   https://www.adobe.com/support/flashplayer/debug_downloads.html

2. ä¸‹è½½FireFoxæ‰©å±•Flash Debugger

3. æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·å³å¯è°ƒè¯•

As3é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—ä¹Ÿä¼šåœ¨JSæ§åˆ¶å°è¾“å‡ºï¼Œä¸¥é‡é”™è¯¯å°†ä¼šå¼¹æ¡†æç¤º


## Scratchå’ŒJSäº¤äº’æ–¹å¼

### å‰ç«¯ > scratch

- æ–¹å¼ä¸€ï¼š åˆ›å»ºobjectæ ‡ç­¾æ—¶å°†é»˜è®¤å‚æ•°ç›´æ¥ä¼ å…¥ã€‚

- æ–¹å¼äºŒï¼šflashè½½å…¥åjsç›´æ¥ä¸as3äº¤äº’ï¼Œå³ç”¨jsç›´æ¥è°ƒç”¨as3çš„æ–¹æ³•ã€‚

As3ä½¿ç”¨ExternalInterface.addCallback(functionName, closure)æ¥æ³¨å†Œä¸€ä¸ªå¯¹jså¼€æ”¾çš„æ¥å£ï¼Œscratché‡Œå·²ç»å¸®æˆ‘ä»¬å°è£…å¥½äº†ä¸€äº›jsæ¥å£ã€‚å¯è‡ªè¡Œä»¿ç…§æ·»åŠ æ–°çš„æ¥å£ã€‚

å¦‚ï¼š

```as3
addExternalCallback("loadProjectByUrl", loadProjectByUrl);
```


### Scratch > å‰ç«¯

scratchå·²æä¾›asè°ƒç”¨jsçš„æ–¹æ³•

externalCall(functionName:String, returnValueCallback:Function = **null**, ...args)

å‚æ•°ï¼š
| å‚æ•°å      | æè¿°        |
| ----------- | ----------- |
| functionName         | jsä¸­çš„å‡½æ•°å |
|ReturnValueCallback|æ‰§è¡Œå®ŒååŒ…å«è¿”å›å€¼çš„å›è°ƒ|
|Args|ä¼ å…¥jsçš„å‚æ•°|

å¦‚ï¼š

```as3
externalCall("getProjectData",null,projectName(),zipData); //è·å–é¡¹ç›®æ–‡ä»¶
```

# Scratchåˆå§‹åŒ–é…ç½®

åˆå§‹åŒ–åœ¨scratch.jsé‡Œçš„flashvarså†…é…ç½®


## é…ç½®ç¤ºä¾‹ï¼š
```
// åˆå§‹åŒ–é…ç½®
var flashvars = {
  extensionDevMode: 'true', //å¯ç”¨æ‹“å±•è®¾å¤‡æ¨¡å¼
  microworldMode: 'false', //å°çª—å£æ¨¡å¼,éšè—èœå•æ ç­‰
  autostart: 'false', //è‡ªåŠ¨è¿è¡Œé¡¹ç›®
  showOnly: 'false', //æ˜¯å¦ä»…ä¿ç•™æ’­æ”¾çª—å£
  urlOverrides: {
    internalAPI: "internalapi/", //ç´ æåº“
    staticFiles: "scratchr2/static/", //ç´ æåº“ç´¢å¼•
    upload: "project/", //sb2æ–‡ä»¶åŠ è½½ç›®å½•
    uploadAPI: 'siteapi/api_file.php', //æ–‡ä»¶ä¸Šä¼ api
    mp4Encoder: "lib/mp4/FW_SWFBridge_ffmpeg.swf", //mp4ç¼–ç æ’ä»¶
  },
  inIE: (navigator.userAgent.indexOf('MSIE') > -1)
};
```

## å°†scratch åµŒå…¥web

æ¨èä½¿ç”¨jsåŠ¨æ€ç”Ÿæˆobjectæ ‡ç­¾æ¥åŠ è½½scratchï¼Œå¹¶å°†flashçš„å¯åŠ¨å‚æ•°ä¸€å¹¶ä¼ å…¥ï¼Œæˆ‘ä»¬å·²åœ¨scratch.jså†…å®ç°ã€‚
swfobject.jså¯ä»¥å¯¹flashè¿›è¡Œä¸€äº›æ“ä½œï¼Œå¦‚ç›‘å¬flashæ˜¯å¦åŠ è½½å®Œæ¯•

```js
window.SWFready = $.Deferred();
$.when(window.SWFready).done(function() {
   //ScratchåŠ è½½å®Œæ¯•
});
```


# APIå‚è€ƒ

é€šè¿‡winodow.scratchå¯¹è±¡æ¥è°ƒç”¨scratchçš„API

scratchå›è°ƒå‡é€šè¿‡window.scratchCallbackå¯¹è±¡å†…çš„æ–¹æ³•ï¼Œå…·ä½“è¯·çœ‹scratch.js

### é€šè¿‡URLåŠ è½½é¡¹ç›®

`window.scratch.loadProjectByUrl`

|å‚æ•°å|æè¿°|
|----|----|
|url|sb2æ–‡ä»¶åœ°å€|
|projectName|é¡¹ç›®åç§°|

### é€šè¿‡UUIDåŠ è½½é¡¹ç›®

`window.scratch.loadProjectById`

| å‚æ•°å | æè¿°        |
| ------ | ----------- |
| url    | sb2æ–‡ä»¶åœ°å€ |
| uuid   | é¡¹ç›®uuid    |

åŠ è½½åé¡¹ç›®çš„UUIDï¼Œéœ€è¦é…ç½®å¥½projectPathå‚æ•°

### JSè§¦å‘ä¸Šä¼ é¡¹ç›®

`window.scratch.uploadProject`

ç”±äºflashçš„å®‰å…¨æ²™ç®±é™åˆ¶ï¼Œjsè§¦å‘ä¸Šä¼ åŠ¨ä½œå¿…é¡»è¦ç”±ç”¨æˆ·ç¡®è®¤ï¼Œæ‰€ä»¥æ— æ³•å»é™¤æ˜¯å¦ä¸Šä¼ çš„å¯¹è¯æ¡†ã€‚

### è·å–sb2é¡¹ç›®æ•°æ®

`window.scratch.getProjectData`

è¿”å›Base64ç¼–ç æ•°æ®

### è·å–æˆªå›¾æ•°æ®

`window.scratch.getScreenshotData`

è¿”å›Base64ç¼–ç æ•°æ®

### è·å–é¡¹ç›®å

`window.scratch.getProjectName`

### è®¾ç½®é¡¹ç›®å

`window.scratch.setProjectName`

å‚æ•°ï¼š

| å‚æ•°å      | æè¿°     |
| ----------- | -------- |
| projectName | é¡¹ç›®åç§° |


### è·å–é¡¹ç›®UUID

`window.scratch.getUUID`

UUIDæ–°å»ºæˆ–ä»URLåŠ è½½é¡¹ç›®æ—¶é‡æ–°ç”Ÿæˆ



## TODO

- å½•åƒMP4ç¼–ç ã€ä¸Šä¼ 
- UIè®¾ç½®
- èœå•æ æŒ‰é’®è®¾ç½®
- â€¦â€¦



# å¸¸è§é—®é¢˜

## è·¨åŸŸé—®é¢˜

Flashä¸èƒ½åŠ è½½éåŒæºèµ„æºï¼Œä¹Ÿå°±æ˜¯scratchæ— æ³•åŠ è½½éåŒä¸€åŸŸåä¸‹çš„é¡¹ç›®ã€ç´ æåº“ã€ç¿»è¯‘ç­‰ç­‰ã€‚

è§£å†³æ–¹æ¡ˆæ˜¯åœ¨èµ„æºæœåŠ¡å™¨æ ¹ç›®å½•ä¸‹æ·»åŠ crossdomain.xmlæ–‡ä»¶ã€‚

ä¸‹ä¸ºå…è®¸æ‰€æœ‰æ¥æºçš„è¯·æ±‚é…ç½®ï¼š

```xml
<?xml version="1.0"?>

<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">

<cross-domain-policy>

<site-control permitted-cross-domain-policies="all"/>

<allow-http-request-headers-from domain="*" headers="*" secure="false" />

<allow-access-from domain="*" secure="false" />

</cross-domain-policy>
```